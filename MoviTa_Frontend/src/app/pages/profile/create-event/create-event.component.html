<form [formGroup]="eventForm" class="row g-4 needs-validation" novalidate (ngSubmit)="createEvent()" [routerLink]="['/profile', ]" ] )>
  <h2 class="text-center mb-4">Crea un evento</h2>

  <!-- Titolo -->
  <div class="col-md-12">
    <label for="title" class="form-label">Titolo</label>
    <input type="text" class="form-control form-control-lg" id="title" formControlName="title">
    <div *ngIf="eventForm.get('title')?.invalid && eventForm.get('title')?.touched" class="invalid-feedback">
      Il titolo è obbligatorio e deve avere massimo 20 caratteri.
    </div>
  </div>

  <!-- Sezione per l'upload delle immagini -->
  <div class="col-md-12">
    <label for="imageUpload" class="form-label">Carica immagini</label>
    <input type="file" class="form-control form-control-lg" id="imageUpload" (change)="onImageUpload($event)" multiple accept="image/*">

    <!-- Mostra l'anteprima delle immagini caricate -->
    <div class="mt-3 d-flex flex-wrap">
      <div *ngFor="let image of imagePreviews; let i = index" class="me-2">
        <img [src]="image" alt="Anteprima" class="img-thumbnail" style="width: 100px; height: 100px;">
        <button type="button" class="btn btn-sm btn-danger d-block mt-1" (click)="removeImage(i)">Rimuovi</button>
      </div>
    </div>
  </div>

  <!-- Data -->
  <div class="col-md-6">
    <label for="date" class="form-label">Data</label>
    <input type="date" class="form-control form-control-lg" id="date" formControlName="date">
  </div>

  <!-- Prezzo -->
  <div class="col-md-6">
    <label for="price" class="form-label">Prezzo</label>
    <input type="number" class="form-control form-control-lg" id="price" formControlName="price">
  </div>

  <!-- Città -->
  <div class="col-md-6">
    <label for="city" class="form-label">Città</label>
    <input type="text" class="form-control form-control-lg" id="city" formControlName="city">
  </div>

  <!-- Indirizzo -->
  <div class="col-md-6">
    <label for="address" class="form-label">Indirizzo</label>
    <input type="text" class="form-control form-control-lg" id="address" formControlName="address">
  </div>

  <!-- Max Partecipanti -->
  <div class="col-md-6">
    <label for="maxParticipants" class="form-label">Numero massimo di partecipanti</label>
    <input type="number" class="form-control form-control-lg" id="maxParticipants" formControlName="maxParticipants">
  </div>

  <!-- Età minima -->
  <div class="col-md-6">
    <label for="minAge" class="form-label">Età minima</label>
    <input type="number" class="form-control form-control-lg" id="minAge" formControlName="minAge">
  </div>

  <!-- Descrizione -->
  <div class="col-12">
    <label for="description" class="form-label">Descrizione</label>
    <textarea class="form-control form-control-lg" id="description" formControlName="description" rows="4"></textarea>
  </div>

  <!-- Categorie selezionate -->
  <div class="col-md-12">
    <h5>Categorie selezionate:</h5>
    <ul class="list-group">
      <li *ngFor="let category of eventForm.get('selectedCategories')?.value" class="list-group-item d-flex justify-content-between align-items-center">
        {{ category }}
        <button type="button" class="btn btn-sm btn-danger" (click)="removeCategory(category)">×</button>
      </li>
    </ul>
  </div>

  <!-- Selezione categoria -->
  <div class="col-md-12 d-flex align-items-center">
    <div class="me-3 flex-grow-1">
      <select class="form-select form-select-lg" [(ngModel)]="selectedCategory">
        <option selected disabled value="">Scegli una categoria</option>
        <option *ngFor="let cat of availableCategories()" [value]="cat">{{ cat }}</option>
      </select>
    </div>
    <button type="button" class="btn btn-lg btn-primary" (click)="addCategory()" [disabled]="!selectedCategory">
      Aggiungi categoria
    </button>
  </div>

  <!-- Bottone per invio -->
  <div class="col-12">
    <button class="btn btn-lg btn-primary w-100" type="submit" [disabled]="!eventForm.valid">Crea Evento</button>
  </div>
</form>
