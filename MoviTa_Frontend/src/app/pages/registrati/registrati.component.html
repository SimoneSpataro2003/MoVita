<div class="container d-flex flex-column justify-content-center align-items-center min-vh-100 px-3" style="gap: 10px;">
  @if (tipo == 0) {
    <div class="d-flex justify-content-between align-items-center w-100 px-3" style="max-width: 400px;">
      <h2 class="text-center m-0 flex-grow-1">Registrati come</h2>
    </div>

    <div class="btn-group" role="group" aria-label="Seleziona tipo" style="gap: 5px;">
      <button type="button" class="btn btn-outline-primary w-100" (click)="tipo = 1">Utente</button>
      <button type="button" class="btn btn-outline-primary w-100" (click)="tipo = 2">Azienda</button>
    </div>
    <p class="text-center">
      <a [routerLink]="['/']">Home</a>
    </p>
  } @else {
    <div class="card p-3 w-100" style="max-width: 40rem; position: relative;">
      <i class="bi bi-arrow-left" (click)="resetForms()"></i>
      <div class="card-body">
        @if (tipo == 1) {
          <form [formGroup]="personForm" (ngSubmit)="registerUser()" class="needs-validation" novalidate>
            <div class="row g-3">
              <div class="col-sm-12 col-md-6">
                <label for="personaNome" class="form-label">Nome</label>
                <input id="personaNome" type="text" class="form-control" formControlName="nome" placeholder="Nome" [ngClass]="{'is-invalid': submitted && personForm.get('nome')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('nome')?.invalid">
                  Inserisci un nome valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaCognome" class="form-label">Cognome</label>
                <input id="personaCognome" type="text" class="form-control" formControlName="personaCognome" placeholder="Cognome" [ngClass]="{'is-invalid': submitted && personForm.get('personaCognome')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('personaCognome')?.invalid">
                  Inserisci un cognome valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaUsername" class="form-label">Username</label>
                <input id="personaUsername" type="text" class="form-control" formControlName="username" placeholder="Username" [ngClass]="{'is-invalid': submitted && personForm.get('username')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('username')?.invalid">
                  Inserisci un username valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaEmail" class="form-label">Email</label>
                <input id="personaEmail" type="email" class="form-control" formControlName="email" placeholder="Email" [ngClass]="{'is-invalid': submitted && personForm.get('email')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('email')?.invalid">
                  Inserisci un'email valida.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaPassword" class="form-label">Password</label>
                <input id="personaPassword" type="password" class="form-control" formControlName="password" placeholder="Password" [ngClass]="{'is-invalid': submitted && personForm.get('password')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('password')?.invalid">
                  Password non valida.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaRipetiPassword" class="form-label">Ripeti Password</label>
                <input id="personaRipetiPassword" type="password" class="form-control" formControlName="ripetiPassword" placeholder="Ripeti password" [ngClass]="{'is-invalid': submitted && (personForm.get('ripetiPassword')?.invalid || personForm.hasError('passwordMismatch'))}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('ripetiPassword')?.invalid || personForm.hasError('passwordMismatch')">
                  Le password non coincidono.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="personaCitta" class="form-label">Città</label>
                <input id="personaCitta" type="text" class="form-control" formControlName="citta" placeholder="Città" [ngClass]="{'is-invalid': submitted && personForm.get('citta')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && personForm.get('citta')?.invalid">
                  Inserisci una città valida.
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary w-100 mt-3">Registrati</button>
          </form>
        } @else if (tipo == 2) {
          <form [formGroup]="agencyForm" (ngSubmit)="registerAgency()" class="needs-validation" novalidate>
            <div class="row g-3">
              <div class="col-sm-12 col-md-6">
                <label for="aziendaNome" class="form-label">Nome</label>
                <input id="aziendaNome" type="text" class="form-control" formControlName="nome" placeholder="Nome" [ngClass]="{'is-invalid': submitted && agencyForm.get('nome')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('nome')?.invalid">
                  Inserisci un nome valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaUsername" class="form-label">Username</label>
                <input id="aziendaUsername" type="text" class="form-control" formControlName="username" placeholder="Username" [ngClass]="{'is-invalid': submitted && agencyForm.get('username')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('username')?.invalid">
                  Inserisci un username valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaEmail" class="form-label">Email</label>
                <input id="aziendaEmail" type="email" class="form-control" formControlName="email" placeholder="Email" [ngClass]="{'is-invalid': submitted && agencyForm.get('email')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('email')?.invalid">
                  Inserisci un'email valida.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaCitta" class="form-label">Città</label>
                <input id="aziendaCitta" type="text" class="form-control" formControlName="citta" placeholder="Città" [ngClass]="{'is-invalid': submitted && agencyForm.get('citta')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('citta')?.invalid">
                  Inserisci una città valida.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaPassword" class="form-label">Password</label>
                <input id="aziendaPassword" type="password" class="form-control" formControlName="password" placeholder="Password" [ngClass]="{'is-invalid': submitted && agencyForm.get('password')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('password')?.invalid">
                  Password non valida.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaRipetiPassword" class="form-label">Ripeti Password</label>
                <input id="aziendaRipetiPassword" type="password" class="form-control" formControlName="ripetiPassword" placeholder="Ripeti password" [ngClass]="{'is-invalid': submitted && (agencyForm.get('ripetiPassword')?.invalid || agencyForm.hasError('passwordMismatch'))}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('ripetiPassword')?.invalid || agencyForm.hasError('passwordMismatch')">
                  Le password non coincidono.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaIndirizzo" class="form-label">Indirizzo</label>
                <input id="aziendaIndirizzo" type="text" class="form-control" formControlName="aziendaIndirizzo" placeholder="Indirizzo" [ngClass]="{'is-invalid': submitted && agencyForm.get('aziendaIndirizzo')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('aziendaIndirizzo')?.invalid">
                  Inserisci un indirizzo valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaRecapito" class="form-label">Recapito</label>
                <input id="aziendaRecapito" type="text" class="form-control" formControlName="aziendaRecapito" placeholder="Recapito" [ngClass]="{'is-invalid': submitted && agencyForm.get('aziendaRecapito')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('aziendaRecapito')?.invalid">
                  Inserisci un recapito valido.
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <label for="aziendaPartitaIva" class="form-label">Partita Iva</label>
                <input id="aziendaPartitaIva" type="text" class="form-control" formControlName="aziendaPartitaIva" placeholder="Partita iva" [ngClass]="{'is-invalid': submitted && agencyForm.get('aziendaPartitaIva')?.invalid}" (input)="submitted = false">
                <div class="invalid-feedback" *ngIf="submitted && agencyForm.get('aziendaPartitaIva')?.invalid">
                  Inserisci una partita IVA valida.
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary w-100 mt-3">Registrati</button>
          </form>
        }
      </div>
    </div>
  }
</div>
